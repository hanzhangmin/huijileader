(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-623b130a"],{"06c5":function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));a("a630"),a("fb6a"),a("b0c0"),a("d3b7"),a("25f0"),a("3ca3");var i=a("6b75");function n(e,t){if(e){if("string"===typeof e)return Object(i["a"])(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?Object(i["a"])(e,t):void 0}}},2909:function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var i=a("6b75");function n(e){if(Array.isArray(e))return Object(i["a"])(e)}a("a4d3"),a("e01a"),a("d28b"),a("a630"),a("e260"),a("d3b7"),a("3ca3"),a("ddb0");function r(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}var s=a("06c5");function o(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function l(e){return n(e)||r(e)||Object(s["a"])(e)||o()}},"3ca3":function(e,t,a){"use strict";var i=a("6547").charAt,n=a("69f3"),r=a("7dd0"),s="String Iterator",o=n.set,l=n.getterFor(s);r(String,"String",(function(e){o(this,{type:s,string:String(e),index:0})}),(function(){var e,t=l(this),a=t.string,n=t.index;return n>=a.length?{value:void 0,done:!0}:(e=i(a,n),t.index+=e.length,{value:e,done:!1})}))},"4df4":function(e,t,a){"use strict";var i=a("0366"),n=a("7b0b"),r=a("9bdd"),s=a("e95a"),o=a("50c4"),l=a("8418"),c=a("35a1");e.exports=function(e){var t,a,d,u,h,b,v=n(e),p="function"==typeof this?this:Array,g=arguments.length,m=g>1?arguments[1]:void 0,f=void 0!==m,y=c(v),w=0;if(f&&(m=i(m,g>2?arguments[2]:void 0,2)),void 0==y||p==Array&&s(y))for(t=o(v.length),a=new p(t);t>w;w++)b=f?m(v[w],w):v[w],l(a,w,b);else for(u=y.call(v),h=u.next,a=new p;!(d=h.call(u)).done;w++)b=f?r(u,m,[d.value,w],!0):d.value,l(a,w,b);return a.length=w,a}},"6b75":function(e,t,a){"use strict";function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,i=new Array(t);a<t;a++)i[a]=e[a];return i}a.d(t,"a",(function(){return i}))},"8d91":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("FeedbackTable")],1)},n=[],r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("BaseCard",[a("div",{attrs:{slot:"header"},slot:"header"},[a("SearchFeedback",{on:{searchFeedback:e.searchFeedback}})],1),a("div",{attrs:{slot:"body"},slot:"body"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%","font-size":"16px"},attrs:{type:"expand",data:e.tableData,border:"",height:"80vh"}},[a("el-table-column",{attrs:{fixed:"",prop:"title",label:"意见建议标题",width:"150"}}),a("el-table-column",{attrs:{prop:"name",label:"建议人",width:"120"}}),a("el-table-column",{attrs:{prop:"time",sortable:"",label:"提交时间",width:"120"}}),a("el-table-column",{attrs:{prop:"content",label:"内容",width:"auto"}}),a("el-table-column",{attrs:{prop:"handler",label:"处理人",width:"120"}}),a("el-table-column",{attrs:{prop:"villagename",label:"所属村",width:"120"}}),a("el-table-column",{attrs:{prop:"status",label:"状态",width:"120"}}),a("el-table-column",{attrs:{prop:"index",fixed:"right",label:"操作",width:"60"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",size:" medium"},on:{click:function(a){return e.handleClick(t.row)}}},[e._v("查看")])]}}])})],1)],1),a("div",{attrs:{slot:"footer"},slot:"footer"},[e.showpageselect?a("div",[a("el-pagination",{attrs:{background:"","current-page":e.currentPage,"page-sizes":[16,20,50,100],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1):a("div",[e._v(" 共"+e._s(e.total)+"条 ")])])]),a("div",{directives:[{name:"show",rawName:"v-show",value:e.showcard,expression:"showcard"}],staticClass:"mask",on:{click:e.hidenMask}},[a("div",{staticClass:"centerbody"},[e._t("centerbody",[a("BaseCard2",[a("div",{attrs:{slot:"header"},slot:"header"},[e._v(" "+e._s(e.itemdata.title)+" "),a("span",{staticClass:"littlespan"},[e._v(e._s(e.itemdata.time))])]),a("div",{attrs:{slot:"body"},slot:"body"},[a("div",{staticClass:"cardcontent"},[e._v(" 意见建议人： "),a("span",[e._v(e._s(e.itemdata.name))])]),a("div",{staticClass:"cardcontent"},[e._v(" 所属村： "),a("span",[e._v(e._s(e.itemdata.villagename))])]),a("div",{staticClass:"cardcontent"},[e._v(" 意见建议内容: "),a("span",[e._v(e._s(e.itemdata.content))])]),a("div",{staticClass:"cardcontent"},[e._v(" 相关图片： "),e.itemdata.img.length>0?a("viewer",{attrs:{images:e.itemdata.img}},e._l(e.itemdata.img,(function(t,i){return a("div",{key:i,staticClass:"img"},[a("img",{attrs:{src:t,onerror:e.errorImg}})])})),0):a("span",[e._v("无")])],1),a("div",{staticClass:"cardcontent"},[e._v(" 意见建议处理行政级别： "),a("span",[e._v(e._s(e.itemdata.status))])]),a("div",{staticClass:"cardcontent"},[e._v(" 意见建议处理人 "),a("span",[e._v(e._s(e.itemdata.handler))])]),a("div",{staticClass:"cardcontent"},[e._v(" 意见建议处理结果： "),a("span",[e._v(e._s(e.itemdata.handlRes))])]),a("div",{staticClass:"cardcontent"},[e._v(" 向上级反馈附带信息 "),a("span",[e._v(e._s(e.itemdata.upMessage))])]),a("div",{staticClass:"cardcontent"},[e._v(" 退回反馈附带信息 "),a("span",[e._v(e._s(e.itemdata.downMessage))])])])])])],2)])],1)},s=[],o=(a("4160"),a("d81d"),a("a434"),a("b0c0"),a("a9e3"),a("d3b7"),a("3ca3"),a("159b"),a("ddb0"),a("2909")),l=a("1bab"),c=a("0c58"),d=a("7ebd"),u=a("ea2c"),h=a("1b72"),b=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"searchbox"},[a("div",{staticClass:"searchobj"},[a("label",{attrs:{for:""}},[e._v(" "+e._s(e.areaname)+"： "),0!=e.$store.state.level?a("el-select",{attrs:{disabled:"",size:e.size,placeholder:"请选择镇/街道"},model:{value:e.townid,callback:function(t){e.townid=t},expression:"townid"}},e._l(e.towns,(function(e){return a("el-option",{key:"town"+e.id,attrs:{label:e.name,value:e.id}})})),1):a("el-select",{attrs:{size:e.size,placeholder:"请选择镇/街道"},model:{value:e.townid,callback:function(t){e.townid=t},expression:"townid"}},e._l(e.towns,(function(e){return a("el-option",{key:"town"+e.id,attrs:{label:e.name,value:e.id}})})),1)],1),a("label",{attrs:{for:""}},[e._v(" 村： "),a("el-select",{attrs:{size:e.size,placeholder:"请选择行政村"},model:{value:e.villageid,callback:function(t){e.villageid=t},expression:"villageid"}},[a("el-option",{attrs:{label:"所有村",value:"0"}}),e._l(e.villages,(function(e){return a("el-option",{key:"village"+e.id,attrs:{label:e.name,value:e.id}})}))],2)],1),a("label",{attrs:{for:""}},[e._v(" 状态： "),a("el-select",{attrs:{size:e.size,albel:"处理状态",placeholder:"请选择处理状态"},model:{value:e.processed,callback:function(t){e.processed=t},expression:"processed"}},e._l(e.processeds,(function(e){return a("el-option",{key:"processed"+e.value,attrs:{label:e.label,value:e.value}})})),1)],1),a("label",{attrs:{for:""}},[e._v(" 类型： "),a("el-select",{attrs:{size:e.size,placeholder:"请选择类型"},model:{value:e.type,callback:function(t){e.type=t},expression:"type"}},e._l(e.types,(function(e){return a("el-option",{key:"type"+e.id,attrs:{label:e.name,value:e.id}})})),1)],1),a("label",{attrs:{for:""}},[e._v(" 时间段： "),a("el-date-picker",{attrs:{size:e.size,type:"daterange",align:"right","unlink-panels":"","range-separator":"至","start-placeholder":"开始月份","end-placeholder":"结束月份","picker-options":e.pickerOptions,change:"changetime"},model:{value:e.time,callback:function(t){e.time=t},expression:"time"}})],1)]),a("div",[a("el-button",{attrs:{type:"primary",size:e.size},on:{click:e.onSubmit}},[e._v("搜索")])],1)])},v=[],p=(a("25f0"),{name:"SearchFeedback",data:function(){return{size:"medium",townid:"0",villages:[],villageid:"0",type:"6",types:[{id:"6",name:"全部类别"},{id:"0",name:"资金"},{id:"1",name:"资产"},{id:"2",name:"资源"},{id:"3",name:"党务"},{id:"4",name:"村务"},{id:"5",name:"其他"}],processed:"0",time:"",processeds:[{value:"0",label:"全部处理情况"},{value:"true",label:"已处理"},{value:"false",label:"未处理"}],pickerOptions:{shortcuts:[{text:"最近一个月",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-2592e6),e.$emit("pick",[a,t])}},{text:"最近半年",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-15552e6),e.$emit("pick",[a,t])}},{text:"最近一年",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-31536e6),e.$emit("pick",[a,t])}}],disabledDate:function(e){return e.getTime()>(new Date).getTime()}}}},computed:{areaid:function(){return Number(this.$store.state.areaid)},areaname:function(){return this.$store.state.areaname},towns:function(){var e=this.$store.state.towns.map((function(e){return{id:e.zhenid.toString(),name:e.zhenName}}));return e}},created:function(){this.townid=this.$store.state.fktownid.toString();try{this.$route.query&&(this.$route.query.townid?(this.processed=this.$route.query.type.toString(),this.villageid="0"):(this.processed=this.$route.query.type.toString(),this.villageid=this.$route.query.villageid.toString()))}catch(a){}var e=new Date;console.log(e.toISOString());var t=new Date;t.setTime(t.getTime()-2592e6),this.time=[t,e],this.getvillages(this.townid),this.onSubmit()},methods:{gettowns:function(e){Object(l["r"])({join:"area",s:{"area.id":{$eq:Number(e)}}}).then((function(e){console.log(e)}))},getvillages:function(e){var t=this;Object(l["z"])({join:"town",s:{"town.id":{$eq:Number(e)}}}).then((function(e){t.villages=e.map((function(e){return{id:e.id.toString(),name:e.name}}))}))},onSubmit:function(){console.log(this.time),this.$emit("searchFeedback",this.townid,this.villageid,this.processed,this.type,this.time)}},watch:{townid:function(e){this.getvillages(this.townid)},time:function(e){},$route:function(e){e.query&&(e.query.townid?(this.townid=e.query.townid.toString(),this.processed=e.query.type.toString()):(this.processed=e.query.type.toString(),this.villageid=e.query.villageid.toString())),this.getvillages(this.townid),this.onSubmit()}}}),g=p,m=a("2877"),f=Object(m["a"])(g,b,v,!1,null,null,null),y=f.exports,w={name:"FeedbackTable",components:{BaseCard:d["a"],themask:h["a"],BaseCard2:u["a"],SearchFeedback:y},data:function(){return{townid:"",pageSize:16,currentPage:1,total:0,pageCount:1,tableData:[],itemdata:{img:[]},loading:!0,showcard:!1,time:"",type:"",processed:"",villageid:"",showpageselect:!0}},created:function(){},methods:{getfeedback_town:function(){var e=this;this.loading=!0,Object(l["z"])({join:"town",fields:"id,name",s:{"town.id":{$eq:Number(this.townid)}}}).then((function(t){var a=t.map((function(t){var a={};switch(e.processed){case"true":a["processed"]=!0;break;case"false":a["processed"]=!1;break;default:break}"6"!=e.type&&(a["type"]=e.type),a["village.id"]={$eq:Number(t.id)};var i=new Date(e.time[1]);return i.setTime(i.getTime()+864e5),a["createdAt"]={$between:[new Date(e.time[0]).toISOString(),i.toISOString()]},Object(l["e"])({join:"village,villager,handler",sort:"createdAt,DESC",s:a})}));Promise.all(a).then((function(t){console.log(t);var a=[];t.forEach((function(e){a.push.apply(a,Object(o["a"])(e))})),console.log(a),e.total=a.length,e.tableData.splice(0),e.tableData=a.map((function(e,t){var a=e.villager.name,i=e.village.name;!0===e.anonymous&&(a="匿名");var n=[];try{null!=e.relatedDocuments&&e.relatedDocuments.forEach((function(e){n.push(e.url)}))}catch(o){}var r="";switch(e.status){case 0:r="村级处理";break;case 1:r="镇级处理";break;case 2:r="区级处理";break;default:r="--";break}var s="--";return null!=e.handler&&(s=Object(c["c"])(e.handler.name)),{id:e.id,index:t,title:Object(c["c"])(e.title),name:Object(c["c"])(a),time:Object(c["a"])(new Date(e.createdAt),"yyyy-MM-dd"),content:Object(c["c"])(e.content),status:r,handler:s,handlRes:Object(c["c"])(e.handlRes),upMessage:Object(c["c"])(e.upMessage),downMessage:Object(c["c"])(e.downMessage),img:n,villagename:i}})),e.loading=!1}))}))},getfeedbacks:function(){var e=this;this.loading=!0;var t={};switch(this.processed){case"true":t["processed"]=!0;break;case"false":t["processed"]=!1;break;default:break}"6"!=this.type&&(t["type"]=this.type),"0"!=this.villageid&&(t["village.id"]={$eq:Number(this.villageid)});var a=new Date(this.time[1]);a.setTime(a.getTime()+864e5),t["createdAt"]={$between:[new Date(this.time[0]).toISOString(),a.toISOString()]},Object(l["e"])({limit:this.pageSize,page:this.currentPage,join:"village,villager,handler",sort:"createdAt,DESC",s:t}).then((function(t){console.log(t),e.loading=!1,e.pageCount=t.pageCount,e.total=t.total,e.tableData.splice(0),e.tableData=t.data.map((function(e,t){var a,i=e.villager.name,n=e.village.name;e.anonymous;try{null!=e.relatedDocuments&&(a=e.relatedDocuments.map((function(e){return e.url})))}catch(o){}var r="";switch(e.status){case 0:r="村级处理";break;case 1:r="镇级处理";break;case 2:r="区级处理";break;default:r="--";break}var s="--";return null!=e.handler&&(s=Object(c["c"])(e.handler.name)),{id:e.id,index:t,title:Object(c["c"])(e.title),name:Object(c["c"])(i),time:Object(c["a"])(new Date(e.createdAt),"yyyy-MM-dd"),content:Object(c["c"])(e.content),status:r,handler:s,handlRes:Object(c["c"])(e.handlRes),upMessage:Object(c["c"])(e.upMessage),downMessage:Object(c["c"])(e.downMessage),img:a,villagename:n}}))}))},searchFeedback:function(e,t,a,i,n){this.time=n,this.type=i,this.townid=e,console.log(this.townid),this.processed=a,this.villageid=t,console.log(t),"0"===t?(this.showpageselect=!1,this.getfeedback_town()):(this.showpageselect=!0,this.getfeedbacks())},handleClick:function(e){console.log(e.index),this.itemdata=this.tableData[Number(e.index)],this.showcard=!0},handleSizeChange:function(e){this.pageSize=Number(e),this.page=1,this.getfeedbacks()},handleCurrentChange:function(e){this.currentPage=Number(e),this.page=Number(e),this.getfeedbacks()},handleClose:function(e){this.$confirm("确认关闭？").then((function(t){e()})).catch((function(e){}))},hidenMask:function(){this.showcard=!1}},watch:{$route:function(e){e.query&&e.query.townid&&(this.showpageselect=!1)}}},k=w,S=Object(m["a"])(k,r,s,!1,null,null,null),_=S.exports,O={name:"sugtable",components:{FeedbackTable:_}},j=O,C=Object(m["a"])(j,i,n,!1,null,null,null);t["default"]=C.exports},a630:function(e,t,a){var i=a("23e7"),n=a("4df4"),r=a("1c7e"),s=!r((function(e){Array.from(e)}));i({target:"Array",stat:!0,forced:s},{from:n})},d28b:function(e,t,a){var i=a("746f");i("iterator")},ddb0:function(e,t,a){var i=a("da84"),n=a("fdbc"),r=a("e260"),s=a("9112"),o=a("b622"),l=o("iterator"),c=o("toStringTag"),d=r.values;for(var u in n){var h=i[u],b=h&&h.prototype;if(b){if(b[l]!==d)try{s(b,l,d)}catch(p){b[l]=d}if(b[c]||s(b,c,u),n[u])for(var v in r)if(b[v]!==r[v])try{s(b,v,r[v])}catch(p){b[v]=r[v]}}}},e01a:function(e,t,a){"use strict";var i=a("23e7"),n=a("83ab"),r=a("da84"),s=a("5135"),o=a("861d"),l=a("9bf2").f,c=a("e893"),d=r.Symbol;if(n&&"function"==typeof d&&(!("description"in d.prototype)||void 0!==d().description)){var u={},h=function(){var e=arguments.length<1||void 0===arguments[0]?void 0:String(arguments[0]),t=this instanceof h?new d(e):void 0===e?d():d(e);return""===e&&(u[t]=!0),t};c(h,d);var b=h.prototype=d.prototype;b.constructor=h;var v=b.toString,p="Symbol(test)"==String(d("test")),g=/^Symbol\((.*)\)[^)]+$/;l(b,"description",{configurable:!0,get:function(){var e=o(this)?this.valueOf():this,t=v.call(e);if(s(u,e))return"";var a=p?t.slice(7,-1):t.replace(g,"$1");return""===a?void 0:a}}),i({global:!0,forced:!0},{Symbol:h})}},fb6a:function(e,t,a){"use strict";var i=a("23e7"),n=a("861d"),r=a("e8b5"),s=a("23cb"),o=a("50c4"),l=a("fc6a"),c=a("8418"),d=a("b622"),u=a("1dde"),h=a("ae40"),b=u("slice"),v=h("slice",{ACCESSORS:!0,0:0,1:2}),p=d("species"),g=[].slice,m=Math.max;i({target:"Array",proto:!0,forced:!b||!v},{slice:function(e,t){var a,i,d,u=l(this),h=o(u.length),b=s(e,h),v=s(void 0===t?h:t,h);if(r(u)&&(a=u.constructor,"function"!=typeof a||a!==Array&&!r(a.prototype)?n(a)&&(a=a[p],null===a&&(a=void 0)):a=void 0,a===Array||void 0===a))return g.call(u,b,v);for(i=new(void 0===a?Array:a)(m(v-b,0)),d=0;b<v;b++,d++)b in u&&c(i,d,u[b]);return i.length=d,i}})}}]);